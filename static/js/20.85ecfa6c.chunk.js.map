{"version":3,"sources":["components/SchoologyButton.js"],"names":["SchoologyButton","props","onClick","a","axios","post","hwbountyAPI","redirectURL","window","location","href","thing","data","nonce","url","localStorage","setItem","enqueueSnackbar","useSnackbar","history","useHistory","useEffect","search","match","oauth_token","split","pop","getItem","catch","er","response","error","setAuthorizationHeader","setTimeout","push","t","connect","withSnackbar"],"mappings":"0RAeaA,EAAkB,SAACC,GAC9B,IAAMC,EAAO,uCAAG,4BAAAC,EAAA,sEACIC,IAAMC,KAAN,UAAcC,IAAd,kBAA2C,CAC3DC,YAAY,GAAD,OAAKC,OAAOC,SAASC,QAFpB,QAIdC,GAHIA,EADU,QAIAC,MAAQD,IACTA,EAAME,OAASF,EAAMG,MAChCC,aAAaC,QAAQ,iBAAkBL,EAAME,OAC7CL,OAAOC,SAASC,KAAOC,EAAMG,KAPjB,2CAAH,qDAULG,EAAoBC,cAApBD,gBACFE,EAAUC,cAsBhB,OArBAC,qBAAU,WAENb,OAAOC,SAASa,QAChBd,OAAOC,SAASa,OAAOC,MAAM,mBAE7B,sBAAC,4BAAApB,EAAA,sEACmBC,IACfC,KADe,UACPC,IADO,kBACsB,CACpCC,YAAY,GAAD,OAAKC,OAAOC,SAASC,MAChCc,YAAahB,OAAOC,SAASa,OAAOG,MAAM,iBAAiBC,MAC3Db,MAAOE,aAAaY,QAAQ,oBAE7BC,OAAM,SAACC,GACNZ,EAAgBY,EAAGC,SAASlB,KAAKmB,OAASF,EAAGC,SAASlB,SAR3D,UACKD,EADL,wDAWCqB,YAAuBrB,EAAMC,MAC7BqB,YAAW,kBAAMd,EAAQe,KAAK,OAAM,KAZrC,0CAAD,KAeD,IAED,cAAC,IAAD,CAAQhC,QAASA,EAAjB,SAA2BiC,EAAE,wCAIlBC,wBAAUC,YAAarC","file":"static/js/20.85ecfa6c.chunk.js","sourcesContent":["import React, { useEffect } from \"react\";\n\nimport Button from \"@material-ui/core/Button\";\n\nimport { connect } from \"react-redux\";\n\nimport axios from \"axios\";\n\nimport { useSnackbar, withSnackbar } from \"notistack\";\n\nimport { useHistory } from \"react-router\";\n\nimport { hwbountyAPI } from \"../redux/types\";\nimport { setAuthorizationHeader } from \"../redux/actions/userActions\";\n\nexport const SchoologyButton = (props) => {\n  const onClick = async () => {\n    let thing = await axios.post(`${hwbountyAPI}/schoologyAuth`, {\n      redirectURL: `${window.location.href}`,\n    });\n    thing = thing.data || thing;\n    if (thing && thing.nonce && thing.url) {\n      localStorage.setItem(\"SchoologyNonce\", thing.nonce);\n      window.location.href = thing.url;\n    }\n  };\n  const { enqueueSnackbar } = useSnackbar();\n  const history = useHistory();\n  useEffect(() => {\n    if (\n      window.location.search &&\n      window.location.search.match(/\\?oauth_token=/)\n    ) {\n      (async () => {\n        let thing = await axios\n          .post(`${hwbountyAPI}/schoologyAuth`, {\n            redirectURL: `${window.location.href}`,\n            oauth_token: window.location.search.split(\"?oauth_token=\").pop(),\n            nonce: localStorage.getItem(\"SchoologyNonce\"),\n          })\n          .catch((er) => {\n            enqueueSnackbar(er.response.data.error || er.response.data);\n          });\n        if (!thing) return;\n        setAuthorizationHeader(thing.data);\n        setTimeout(() => history.push(\"/\"), 500);\n      })();\n    }\n  }, []);\n  return (\n    <Button onClick={onClick}>{t(\"schoologyButton.authWithSchoology\")}</Button>\n  );\n};\n\nexport default connect()(withSnackbar(SchoologyButton));\n"],"sourceRoot":""}